--Check Dublicates
SELECT purchase_id, COUNT(*)
FROM ecommerce_purchases
GROUP BY purchase_id
HAVING COUNT(*) > 1;

--Check Missing Value
SELECT *
FROM ecommerce_purchases
WHERE name IS NULL
   OR email IS NULL
   OR country IS NULL
   OR product IS NULL
   OR price IS NULL;
   
--Check Invalid email
SELECT *
FROM ecommerce_purchases
WHERE email NOT LIKE '%@%';

--Check Invalid Price
SELECT *
FROM ecommerce_purchases
WHERE price <= 0;

--Check Timestamb formate
SELECT timestamp
FROM ecommerce_purchases
LIMIT 20;

--Check Null and Blank VALUES
SELECT *
FROM ecommerce_purchases
WHERE purchase_id IS NULL
   OR name IS NULL OR name = ''
   OR email IS NULL OR email = ''
   OR country IS NULL OR country = ''
   OR product IS NULL OR product = ''
   OR price IS NULL
   OR payment_method IS NULL OR payment_method = ''
   OR timestamp IS NULL;

--Fix Invalid email formate
SELECT rowid, email 
FROM ecommerce_purchases
WHERE email NOT LIKE '%@%.%';

--Remove rows with negative or zero price
SELECT *
FROM ecommerce_purchases
WHERE price <= 0;

--Standardise contry name
SELECT DISTINCT country
FROM ecommerce_purchases;

--UPDATE
UPDATE ecommerce_purchases
SET country = 'United States'
WHERE country IN ('USA', 'US', 'America');

--Check for Dublicate ROWS
SELECT purchase_id, COUNT(*)
FROM ecommerce_purchases
GROUP BY purchase_id
HAVING COUNT(*) > 1;

--Verify Clean Data
SELECT COUNT(*) FROM ecommerce_purchases;
SELECT * FROM ecommerce_purchases LIMIT 10;

SELECT * FROM production_clean LIMIT 10;


SELECT SUM(price) AS total_revenue
FROM production_clean;


--Total revenue by contry
SELECT country, SUM(price) AS total_revenue
FROM production_clean
GROUP BY country
ORDER BY total_revenue DESC;

--Top 10 Customer by spending
SELECT name, SUM(price) AS total_spent
FROM production_clean
GROUP BY name
ORDER BY total_spent DESC
LIMIT 10;

-- Most Purchase Product 
SELECT product, COUNT(*) AS total_sold
FROM production_clean
GROUP BY product
ORDER BY total_sold DESC
LIMIT 1;

--Order per Contry
SELECT country, COUNT(*) AS total_orders
FROM production_clean
GROUP BY country
ORDER BY total_orders DESC;

