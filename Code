--Check Dublicates
SELECT purchase_id, COUNT(*)
FROM ecommerce_purchases
GROUP BY purchase_id
HAVING COUNT(*) > 1;

--Check Missing Value
SELECT *
FROM ecommerce_purchases
WHERE name IS NULL
   OR email IS NULL
   OR country IS NULL
   OR product IS NULL
   OR price IS NULL;
   
--Check Invalid email
SELECT *
FROM ecommerce_purchases
WHERE email NOT LIKE '%@%';

--Check Invalid Price
SELECT *
FROM ecommerce_purchases
WHERE price <= 0;

--Check Timestamb formate
SELECT timestamp
FROM ecommerce_purchases
LIMIT 20;

--Check Null and Blank VALUES
SELECT *
FROM ecommerce_purchases
WHERE purchase_id IS NULL
   OR name IS NULL OR name = ''
   OR email IS NULL OR email = ''
   OR country IS NULL OR country = ''
   OR product IS NULL OR product = ''
   OR price IS NULL
   OR payment_method IS NULL OR payment_method = ''
   OR timestamp IS NULL;

--Fix Invalid email formate
SELECT rowid, email 
FROM ecommerce_purchases
WHERE email NOT LIKE '%@%.%';

--Remove rows with negative or zero price
SELECT *
FROM ecommerce_purchases
WHERE price <= 0;

--Standardise contry name
SELECT DISTINCT country
FROM ecommerce_purchases;

--UPDATE
UPDATE ecommerce_purchases
SET country = 'United States'
WHERE country IN ('USA', 'US', 'America');

--Check for Dublicate ROWS
SELECT purchase_id, COUNT(*)
FROM ecommerce_purchases
GROUP BY purchase_id
HAVING COUNT(*) > 1;

--Verify Clean Data
SELECT COUNT(*) FROM ecommerce_purchases;
SELECT * FROM ecommerce_purchases LIMIT 10;
